# Trading Oracle Dashboard

A comprehensive, real-time web dashboard for visualizing trading decisions, feature analysis, performance metrics, and system status.

## üéØ Overview

The Trading Oracle Dashboard provides a professional-grade interface for monitoring and analyzing trading decisions generated by the oracle system. Built with Django, Tailwind CSS, Chart.js, and Alpine.js, it offers real-time updates, interactive visualizations, and detailed analytics.

## ‚ú® Key Features

### 1. **Dashboard Overview** (`/dashboard/`)
- **Key Metrics Cards**: Total decisions, active symbols, average confidence, system status
- **Decision Timeline Chart**: 30-day stacked bar chart showing signal distribution over time
- **Confidence Distribution**: Doughnut chart showing confidence level distribution
- **Signal Distribution**: Visual breakdown of signals (STRONG_BUY through STRONG_SELL) over last 7 days
- **Top Performing Symbols**: Table of most actively traded symbols with decision counts
- **Recent Decisions Table**: Last 20 decisions with key parameters

### 2. **Feature Analysis** (`/dashboard/features/`)
- **Feature Power Metrics**: Ranking of all features by their absolute contribution power
- **Effect Classification**: Each feature marked as BULLISH, BEARISH, or NEUTRAL
- **Accuracy Indicators**: Usage count, contribution statistics, signal distribution
- **Category Breakdown**: Features organized by category (TECHNICAL, MACRO, CRYPTO_DERIVATIVES, etc.)
- **Interactive Power Chart**: Top 15 features visualized with bullish/bearish power comparison
- **Detailed Statistics**:
  - Power: Average absolute contribution (0.0 - 2.0+ scale)
  - Effect: Dominant directional bias with strength percentage
  - Contribution: Average signed contribution (positive = bullish, negative = bearish)
  - Usage: Number of times feature was calculated
  - Distribution: Breakdown of positive/neutral/negative signals

### 3. **Decision History** (`/dashboard/history/`)
- **Advanced Filtering**:
  - Symbol filter
  - Timeframe filter (15m, 1h, 4h, 1d, 1w)
  - Signal filter (STRONG_BUY through STRONG_SELL)
  - Time period (1, 7, 30, 90 days)
- **Filtered Statistics**: Total count, average confidence, most common signal
- **Paginated Results**: 50 decisions per page
- **Detailed Table**: Timestamp, symbol, timeframe, market type, signal, confidence, entry price, R:R
- **Quick Actions**: Direct link to detailed decision view

### 4. **Live Monitor** (`/dashboard/live/`)
- **Real-Time Updates**: Auto-refresh with configurable intervals (10s, 30s, 60s)
- **Active Symbol Cards**: Current price, volume, last update time for all tracked symbols
- **Latest Decisions Stream**: Live-updating feed of new decisions
- **Visual Highlights**: New decisions temporarily highlighted
- **System Status**: Last update timestamp and live indicator
- **Auto-Refresh Toggle**: Enable/disable automatic updates

### 5. **Decision Detail** (`/dashboard/decision/<id>/`)
- **Comprehensive Decision View**:
  - **Header Section**: Symbol, timestamp, timeframe, market type, signal, bias, confidence
  - **Key Metrics**: Risk/reward ratio, raw score
  - **Trade Parameters**: Entry price, stop loss, take profit with visual formatting
  - **Consensus Analysis**:
    - Agreement level (STRONG/MODERATE/WEAK/NO consensus)
    - Consensus percentage with progress bar
    - Consensus explanation
    - Conflict detection (e.g., "Technical bullish but Macro bearish")
  - **Market Regime Context**: All regime parameters (trend, volatility, squeeze, filters)
  - **Top 5 Drivers**: Most influential features with:
    - Contribution score
    - Category
    - Explanation
    - Weight and strength breakdown
  - **All Feature Contributions by Category**:
    - Expandable category sections
    - Total category contribution
    - Individual feature details (raw value, direction, strength, weight)
  - **Invalidation Conditions**: List of conditions that would invalidate the signal

## üìä Chart Types & Visualizations

### 1. **Decision Timeline Chart** (Stacked Bar)
- **Data**: Daily decision counts by signal type over 30 days
- **Colors**: Signal-specific (green for buys, red for sells, gray for neutral)
- **Interactive**: Hover for detailed counts per signal per day

### 2. **Confidence Distribution** (Doughnut)
- **Bins**: 0-50%, 50-60%, 60-70%, 70-80%, 80-90%, 90-100%
- **Colors**: Red (low) to green (high confidence)
- **Interactive**: Hover shows count and percentage

### 3. **Feature Power Chart** (Horizontal Bar)
- **Data**: Top 15 features by average absolute contribution
- **Datasets**: Bullish power (green) vs Bearish power (red)
- **Sorting**: By total usage count (most used features first)

### 4. **Consensus Breakdown** (API available)
- **Levels**: Strong, Moderate, Weak, No consensus, Unknown
- **Data**: Count of decisions at each consensus level

## üé® UI Design & UX

### Color System
- **Signals**:
  - STRONG_BUY: Dark green (#16a34a)
  - BUY: Green (#22c55e)
  - WEAK_BUY: Light green (#86efac)
  - NEUTRAL: Gray (#9ca3af)
  - WEAK_SELL: Light red (#fca5a5)
  - SELL: Red (#ef4444)
  - STRONG_SELL: Dark red (#dc2626)

- **Effects**:
  - BULLISH: Green background (#f0fdf4) with green text (#166534)
  - BEARISH: Red background (#fef2f2) with red text (#991b1b)
  - NEUTRAL: Gray background (#f9fafb) with gray text (#374151)

- **Consensus Levels**:
  - STRONG_CONSENSUS: Green (#dcfce7)
  - MODERATE_CONSENSUS: Blue (#dbeafe)
  - WEAK_CONSENSUS: Yellow (#fef3c7)
  - NO_CONSENSUS: Red (#fee2e2)

### Responsive Design
- **Mobile-First**: Optimized for all screen sizes
- **Breakpoints**: sm (640px), md (768px), lg (1024px), xl (1280px)
- **Grid Layouts**: Automatically adjust from 1 column (mobile) to 4 columns (desktop)

### Interactive Elements
- **Hover States**: All cards and rows have hover effects
- **Tooltips**: Charts show detailed data on hover
- **Progress Bars**: Confidence levels visualized with animated bars
- **Collapsible Sections**: Feature categories and contribution details can expand/collapse
- **Live Updates**: Real-time decision feed with highlight animations

## üîå API Endpoints

All API endpoints return JSON and are optimized for chart rendering.

### 1. **Decision Chart Data**
```
GET /dashboard/api/chart/decisions/?days=30
```
Returns decision timeline data grouped by date and signal type.

**Response**:
```json
{
  "labels": ["2026-01-01", "2026-01-02", ...],
  "datasets": [
    {
      "label": "STRONG_BUY",
      "data": [5, 3, 7, ...]
    },
    ...
  ]
}
```

### 2. **Confidence Distribution**
```
GET /dashboard/api/chart/confidence/?days=30
```
Returns confidence histogram data.

**Response**:
```json
{
  "labels": ["0-50%", "50-60%", "60-70%", "70-80%", "80-90%", "90-100%"],
  "data": [2, 15, 45, 78, 92, 123]
}
```

### 3. **Feature Power Chart**
```
GET /dashboard/api/chart/feature-power/?limit=15&days=30
```
Returns top features by power with bullish/bearish breakdown.

**Response**:
```json
{
  "labels": ["RSI", "MACD", "FundingRate", ...],
  "datasets": [
    {
      "label": "Bullish Power",
      "data": [0.45, 0.38, ...],
      "backgroundColor": "rgba(34, 197, 94, 0.7)"
    },
    {
      "label": "Bearish Power",
      "data": [0, 0.12, ...],
      "backgroundColor": "rgba(239, 68, 68, 0.7)"
    }
  ],
  "categories": ["TECHNICAL", "TECHNICAL", "CRYPTO_DERIVATIVES", ...]
}
```

### 4. **Consensus Breakdown**
```
GET /dashboard/api/chart/consensus/?days=30
```
Returns consensus level distribution.

**Response**:
```json
{
  "labels": ["STRONG_CONSENSUS", "MODERATE_CONSENSUS", ...],
  "data": [45, 78, 23, 12, 5]
}
```

### 5. **Live Updates**
```
GET /dashboard/api/live-updates/?last_id=1234
```
Returns new decisions since `last_id`.

**Response**:
```json
{
  "decisions": [
    {
      "id": 1235,
      "timestamp": "2026-01-11T12:34:56Z",
      "symbol": "BTCUSDT",
      "timeframe": "1h",
      "signal": "BUY",
      "bias": "BULLISH",
      "confidence": 75,
      "entry_price": "42500.00"
    },
    ...
  ],
  "latest_id": 1240
}
```

### 6. **Symbol Performance**
```
GET /dashboard/api/symbol/BTCUSDT/?days=30
```
Returns decisions and price data for a specific symbol.

**Response**:
```json
{
  "decisions": [
    {
      "timestamp": "2026-01-11T12:00:00Z",
      "signal": "BUY",
      "confidence": 75,
      "entry_price": "42500.00"
    },
    ...
  ],
  "prices": [
    {
      "timestamp": "2026-01-11T12:00:00Z",
      "close": 42500.0,
      "volume": 1234567.89
    },
    ...
  ]
}
```

## üöÄ Getting Started

### Prerequisites
- Django 5.2.10
- PostgreSQL (recommended) or SQLite
- Python 3.10+

### Installation

1. **Ensure dashboard is in installed apps** (already configured):
```python
# trading_oracle/settings.py
INSTALLED_APPS = [
    ...
    'oracle',
    'oracle.dashboard',  # Dashboard app
    ...
]
```

2. **URLs are already configured** in `trading_oracle/urls.py`:
```python
urlpatterns = [
    path('', RedirectView.as_view(url='/dashboard/', permanent=False)),
    path('dashboard/', include('oracle.dashboard.urls')),
    ...
]
```

3. **Run migrations** (if any new models added):
```bash
python manage.py migrate
```

4. **Start the development server**:
```bash
python manage.py runserver
```

5. **Access the dashboard**:
```
http://localhost:8000/dashboard/
```
(Root URL `/` automatically redirects to dashboard)

## üìñ Usage Examples

### Viewing Feature Power
1. Navigate to `/dashboard/features/`
2. Review the Feature Power Chart showing top 15 features
3. Expand any category to see detailed feature statistics
4. Look for:
   - **High Power + Bullish Effect**: Strong bullish indicators
   - **High Power + Bearish Effect**: Strong bearish indicators
   - **High Power + Neutral Effect**: Regime/volatility indicators

### Analyzing a Decision
1. Go to `/dashboard/history/`
2. Use filters to find specific decisions
3. Click "Details" on any decision
4. Review:
   - **Consensus Analysis**: Check for conflicts
   - **Top 5 Drivers**: Understand why the signal was generated
   - **Regime Context**: Market conditions at decision time
   - **All Contributions**: Deep dive into every feature's input

### Monitoring Live
1. Navigate to `/dashboard/live/`
2. Enable auto-refresh (default: 30s interval)
3. Watch for new decisions in real-time
4. Check active symbol prices and volumes
5. Click "View Details" on any decision for deeper analysis

### Understanding Feature Accuracy
1. Go to `/dashboard/features/`
2. For each feature, check:
   - **Effect**: Is it consistently bullish, bearish, or neutral?
   - **Effect Strength**: How dominant is the effect? (>60% = strong)
   - **Power**: How much influence does it have? (>0.5 = significant)
   - **Distribution**: Ratio of positive/neutral/negative signals
3. Compare features within same category
4. Identify most reliable features (high power + consistent effect)

## üéØ Key Metrics Explained

### Power
- **Definition**: Average absolute contribution of a feature to decisions
- **Range**: 0.0 (no influence) to 2.0+ (very strong influence)
- **Interpretation**:
  - < 0.2: Low power (minor influence)
  - 0.2 - 0.5: Moderate power
  - 0.5 - 1.0: High power
  - > 1.0: Very high power

### Effect
- **BULLISH**: >60% of contributions are positive (supports buy signals)
- **BEARISH**: >60% of contributions are negative (supports sell signals)
- **NEUTRAL**: Mixed contributions (50-60% either direction)

### Confidence
- **Definition**: System's confidence in the decision (0-100%)
- **Influenced by**:
  - Consensus level (higher consensus = higher confidence)
  - Conflicts (conflicts reduce confidence)
  - Regime filters (ranging markets reduce confidence)
- **Ranges**:
  - 85-100%: High confidence
  - 70-85%: Moderate confidence
  - 50-70%: Low confidence
  - <50%: Very low confidence

### Consensus
- **STRONG_CONSENSUS** (‚â•75%): Most features agree on direction
- **MODERATE_CONSENSUS** (60-75%): Good agreement
- **WEAK_CONSENSUS** (50-60%): Slight majority
- **NO_CONSENSUS** (<50%): Features disagree

## üîß Customization

### Changing Chart Colors
Edit `/oracle/dashboard/templates/dashboard/base.html`:
```javascript
const signalColors = {
    'STRONG_BUY': '#your-color',
    ...
};
```

### Adjusting Auto-Refresh Interval
Edit `/oracle/dashboard/templates/dashboard/live.html`:
```html
<select x-model="interval">
    <option value="5">Every 5s</option>  <!-- Add custom intervals -->
    <option value="10">Every 10s</option>
    ...
</select>
```

### Adding Custom API Endpoints
1. Create view in `/oracle/dashboard/views.py`
2. Add URL to `/oracle/dashboard/urls.py`
3. Call from frontend with `fetch()`

## üìä Performance Optimization

### Database Queries
- All views use `select_related()` and `prefetch_related()` to minimize queries
- Indexes on `timestamp`, `symbol`, `timeframe` fields
- Aggregate queries for statistics

### Frontend Performance
- Charts use lazy loading (loaded after page render)
- Images and assets served via CDN (Tailwind, Chart.js, Alpine.js)
- Pagination limits results to 50 per page
- Live updates fetch only new data (incremental)

### Caching Recommendations
For production, consider adding caching:
```python
from django.views.decorators.cache import cache_page

@cache_page(60)  # Cache for 60 seconds
def api_decision_chart_data(request):
    ...
```

## üêõ Troubleshooting

### Charts Not Loading
- **Issue**: Charts show empty or don't render
- **Fix**: Check browser console for JavaScript errors. Ensure Chart.js CDN is accessible.

### No Decisions Showing
- **Issue**: Dashboard shows "No decisions yet"
- **Fix**: Run `python manage.py run_analysis` to generate decisions. Ensure symbols and features are initialized.

### Live Updates Not Working
- **Issue**: Auto-refresh doesn't show new decisions
- **Fix**: Check that decisions are being created. Verify API endpoint `/dashboard/api/live-updates/` returns data.

### Slow Performance
- **Issue**: Dashboard pages load slowly
- **Fix**:
  - Add database indexes: `python manage.py sqlmigrate oracle <migration_number>`
  - Enable query caching (see Performance Optimization)
  - Reduce time period filters (e.g., 7 days instead of 90 days)

## üîê Security Considerations

### Production Deployment
1. **Authentication**: Add login required decorators
   ```python
   from django.contrib.auth.decorators import login_required

   @login_required
   def dashboard_home(request):
       ...
   ```

2. **API Rate Limiting**: Use Django REST Framework throttling

3. **HTTPS Only**: Configure SSL/TLS in production

4. **CSRF Protection**: Enabled by default in Django

5. **SQL Injection**: All queries use Django ORM (safe by default)

## üìà Future Enhancements

Potential future additions:
- ‚úÖ Backtesting integration (show historical accuracy)
- ‚úÖ Performance metrics dashboard
- ‚è≥ User settings and preferences
- ‚è≥ Custom alert system
- ‚è≥ Export to PDF/Excel
- ‚è≥ Mobile app version
- ‚è≥ WebSocket real-time updates (instead of polling)
- ‚è≥ Advanced filtering with saved searches
- ‚è≥ Strategy comparison view
- ‚è≥ Portfolio tracking integration

## üìù License

Part of the Trading Oracle project. See main project LICENSE for details.

## üôè Credits

Built with:
- **Django 5.2.10** - Web framework
- **Tailwind CSS** - Utility-first CSS framework
- **Chart.js** - JavaScript charting library
- **Alpine.js** - Lightweight JavaScript framework
- **Font Awesome** - Icon library

## üìû Support

For issues or questions:
1. Check this README
2. Review Django logs: `python manage.py runserver --verbosity 2`
3. Check browser console for frontend errors
4. File an issue in the main project repository

---

**Status**: ‚úÖ Production Ready | **Version**: 1.0.0 | **Last Updated**: January 2026
